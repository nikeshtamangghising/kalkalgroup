(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2313],{19825:()=>{},23388:()=>{},34051:(e,t,r)=>{"use strict";r.d(t,{A4:()=>i,OS:()=>l,vv:()=>u});let n={NPR:{code:"NPR",symbol:"NPR",name:"Nepalese Rupee",locale:"ne-NP",defaultLocale:"en-NP",decimals:2,freeShippingThreshold:200},USD:{code:"USD",symbol:"$",name:"US Dollar",locale:"en-US",decimals:2,freeShippingThreshold:75},EUR:{code:"EUR",symbol:"â‚¬",name:"Euro",locale:"en-EU",decimals:2,freeShippingThreshold:65},GBP:{code:"GBP",symbol:"\xa3",name:"British Pound",locale:"en-GB",decimals:2,freeShippingThreshold:55},INR:{code:"INR",symbol:"INR",name:"Indian Rupee",locale:"en-IN",decimals:2,freeShippingThreshold:5e3}},l="NPR";function d(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l;return n[e]||n[l]}function u(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l,r=arguments.length>2?arguments[2]:void 0,n=d(t),{showSymbol:u=!0,minimumFractionDigits:i,maximumFractionDigits:a}=r||{};try{if("NPR"===t){let t=new Intl.NumberFormat("en-NP",{minimumFractionDigits:null!=i?i:n.decimals,maximumFractionDigits:null!=a?a:n.decimals}).format(e);return u?"".concat(n.symbol," ").concat(t):t}return new Intl.NumberFormat(n.locale,{style:"currency",currency:n.code,minimumFractionDigits:null!=i?i:n.decimals,maximumFractionDigits:null!=a?a:n.decimals}).format(e)}catch(r){let t=e.toFixed(n.decimals);return u?"".concat(n.symbol," ").concat(t):t}}function i(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l;return d(e).freeShippingThreshold}},76889:()=>{},85630:()=>{},87110:(e,t,r)=>{"use strict";r.d(t,{$g:()=>eB,rs:()=>ez});var n={};r.r(n),r.d(n,{AddressType:()=>H,GalleryCategory:()=>z,InventoryChangeType:()=>J,OrderStatus:()=>x,PaymentStatus:()=>V,ProductStatus:()=>G,Role:()=>F,ShipmentStatus:()=>B,accountRelations:()=>e_,accounts:()=>j,addressRelations:()=>eq,addresses:()=>X,brandRelations:()=>eE,brands:()=>et,cartItemRelations:()=>eh,cartItems:()=>ei,cartRelations:()=>ev,carts:()=>eu,categories:()=>ee,categoryRelations:()=>ey,gallery:()=>ef,inventoryAdjustmentRelations:()=>eA,inventoryAdjustments:()=>ed,orderItemRelations:()=>eD,orderItems:()=>eo,orderRelations:()=>eR,orders:()=>ea,paymentRelations:()=>eT,payments:()=>es,productImageRelations:()=>eI,productImages:()=>el,productRelations:()=>eQ,productVariantRelations:()=>eg,productVariants:()=>en,products:()=>er,profileRelations:()=>ep,profiles:()=>Y,sessionRelations:()=>em,sessions:()=>Z,shipmentRelations:()=>eP,shipments:()=>ec,siteSettings:()=>ew,siteSettingsRelations:()=>eS,userActivities:()=>eb,userActivitiesRelations:()=>eC,userInterests:()=>eK,userInterestsRelations:()=>eL,userRelations:()=>eN,users:()=>$,verificationTokens:()=>W});var l=r(34051),d=r(2405),u=r(97474),i=r(78027),a=r(99613),o=r(44826),s=r(43233),c=r(546),f=r(98758),N=r(15256),p=r(86736),_=r(15501),m=r(2590);function q(){let e=(0,i._)(["gen_random_uuid()"]);return q=function(){return e},e}function y(){let e=(0,i._)(["gen_random_uuid()"]);return y=function(){return e},e}function E(){let e=(0,i._)(["gen_random_uuid()"]);return E=function(){return e},e}function Q(){let e=(0,i._)(["gen_random_uuid()"]);return Q=function(){return e},e}function g(){let e=(0,i._)(["gen_random_uuid()"]);return g=function(){return e},e}function I(){let e=(0,i._)(["gen_random_uuid()"]);return I=function(){return e},e}function A(){let e=(0,i._)(["gen_random_uuid()"]);return A=function(){return e},e}function v(){let e=(0,i._)(["'{}'::text[]"]);return v=function(){return e},e}function h(){let e=(0,i._)(["'{}'::text[]"]);return h=function(){return e},e}function R(){let e=(0,i._)(["gen_random_uuid()"]);return R=function(){return e},e}function D(){let e=(0,i._)(["gen_random_uuid()"]);return D=function(){return e},e}function T(){let e=(0,i._)(["gen_random_uuid()"]);return T=function(){return e},e}function P(){let e=(0,i._)(["gen_random_uuid()"]);return P=function(){return e},e}function w(){let e=(0,i._)(["gen_random_uuid()"]);return w=function(){return e},e}function S(){let e=(0,i._)(["gen_random_uuid()"]);return S=function(){return e},e}function b(){let e=(0,i._)(["gen_random_uuid()"]);return b=function(){return e},e}function C(){let e=(0,i._)(["gen_random_uuid()"]);return C=function(){return e},e}function K(){let e=(0,i._)(["gen_random_uuid()"]);return K=function(){return e},e}function L(){let e=(0,i._)(["gen_random_uuid()"]);return L=function(){return e},e}function U(){let e=(0,i._)(["'{}'::text[]"]);return U=function(){return e},e}function k(){let e=(0,i._)(["gen_random_uuid()"]);return k=function(){return e},e}function M(){let e=(0,i._)(["gen_random_uuid()"]);return M=function(){return e},e}function O(){let e=(0,i._)(["gen_random_uuid()"]);return O=function(){return e},e}let F={CUSTOMER:"CUSTOMER",ADMIN:"ADMIN"},H={SHIPPING:"SHIPPING",BILLING:"BILLING"},G={DRAFT:"DRAFT",PUBLISHED:"PUBLISHED",ACTIVE:"ACTIVE",DISCONTINUED:"DISCONTINUED"},J={MANUAL_ADJUSTMENT:"MANUAL_ADJUSTMENT",RESTOCK:"RESTOCK",DAMAGED:"DAMAGED",ORDER_PLACED:"ORDER_PLACED",ORDER_RETURNED:"ORDER_RETURNED",INITIAL:"INITIAL",OTHER:"OTHER"},x={DRAFT:"DRAFT",PENDING_PAYMENT:"PENDING_PAYMENT",PROCESSING:"PROCESSING",FULFILLED:"FULFILLED",CANCELLED:"CANCELLED",REFUNDED:"REFUNDED"},V={PENDING:"PENDING",AUTHORIZED:"AUTHORIZED",CAPTURED:"CAPTURED",FAILED:"FAILED",REFUNDED:"REFUNDED"},B={PENDING:"PENDING",LABEL_CREATED:"LABEL_CREATED",IN_TRANSIT:"IN_TRANSIT",DELIVERED:"DELIVERED",CANCELLED:"CANCELLED"},z={FACTORY:"FACTORY",PRODUCTION:"PRODUCTION",PRODUCTS:"PRODUCTS",TEAM:"TEAM",FARMERS:"FARMERS",EVENTS:"EVENTS",FACILITY:"FACILITY"},$=(0,o.cJ)("users",{id:(0,s.Qq)("id").primaryKey().default((0,m.ll)(q())),email:(0,s.Qq)("email").notNull().unique(),name:(0,s.Qq)("name").notNull(),passwordHash:(0,s.Qq)("password_hash"),role:(0,s.Qq)("role").notNull().default(F.CUSTOMER),phone:(0,s.Qq)("phone"),avatarUrl:(0,s.Qq)("avatar_url"),lastLoginAt:(0,c.vE)("last_login_at"),createdAt:(0,c.vE)("created_at").notNull().defaultNow(),updatedAt:(0,c.vE)("updated_at").notNull().defaultNow()}),Y=(0,o.cJ)("profiles",{userId:(0,s.Qq)("user_id").primaryKey().references(()=>$.id),gender:(0,s.Qq)("gender"),dateOfBirth:(0,c.vE)("date_of_birth"),marketingOptIn:(0,f.zM)("marketing_opt_in").notNull().default(!1),preferences:(0,N.Pq)("preferences"),createdAt:(0,c.vE)("created_at").notNull().defaultNow(),updatedAt:(0,c.vE)("updated_at").notNull().defaultNow()}),j=(0,o.cJ)("accounts",{id:(0,s.Qq)("id").primaryKey().default((0,m.ll)(y())),userId:(0,s.Qq)("user_id").notNull().references(()=>$.id),type:(0,s.Qq)("type").notNull(),provider:(0,s.Qq)("provider").notNull(),providerAccountId:(0,s.Qq)("provider_account_id").notNull(),refreshToken:(0,s.Qq)("refresh_token"),accessToken:(0,s.Qq)("access_token"),expiresAt:(0,p.nd)("expires_at"),tokenType:(0,s.Qq)("token_type"),scope:(0,s.Qq)("scope"),idToken:(0,s.Qq)("id_token"),sessionState:(0,s.Qq)("session_state")}),Z=(0,o.cJ)("sessions",{id:(0,s.Qq)("id").primaryKey().default((0,m.ll)(E())),sessionToken:(0,s.Qq)("session_token").notNull().unique(),userId:(0,s.Qq)("user_id").notNull().references(()=>$.id),expires:(0,c.vE)("expires").notNull()}),W=(0,o.cJ)("verification_tokens",{identifier:(0,s.Qq)("identifier").notNull(),token:(0,s.Qq)("token").notNull().unique(),expires:(0,c.vE)("expires").notNull()}),X=(0,o.cJ)("addresses",{id:(0,s.Qq)("id").primaryKey().default((0,m.ll)(Q())),userId:(0,s.Qq)("user_id").notNull().references(()=>$.id),label:(0,s.Qq)("label"),type:(0,s.Qq)("type").notNull().default(H.SHIPPING),fullName:(0,s.Qq)("full_name").notNull(),email:(0,s.Qq)("email"),phone:(0,s.Qq)("phone"),line1:(0,s.Qq)("line1").notNull(),line2:(0,s.Qq)("line2"),city:(0,s.Qq)("city").notNull(),state:(0,s.Qq)("state"),postalCode:(0,s.Qq)("postal_code").notNull(),country:(0,s.Qq)("country").notNull(),isDefault:(0,f.zM)("is_default").notNull().default(!1),createdAt:(0,c.vE)("created_at").notNull().defaultNow(),updatedAt:(0,c.vE)("updated_at").notNull().defaultNow()}),ee=(0,o.cJ)("categories",{id:(0,s.Qq)("id").primaryKey().default((0,m.ll)(g())),name:(0,s.Qq)("name").notNull(),slug:(0,s.Qq)("slug").notNull().unique(),description:(0,s.Qq)("description"),parent_id:(0,s.Qq)("parent_id"),image_url:(0,s.Qq)("image_url"),is_active:(0,f.zM)("is_active").notNull().default(!0),sort_order:(0,p.nd)("sort_order").notNull().default(0),created_at:(0,c.vE)("created_at").notNull().defaultNow(),updated_at:(0,c.vE)("updated_at").notNull().defaultNow()}),et=(0,o.cJ)("brands",{id:(0,s.Qq)("id").primaryKey().default((0,m.ll)(I())),name:(0,s.Qq)("name").notNull().unique(),slug:(0,s.Qq)("slug").notNull().unique(),description:(0,s.Qq)("description"),logoUrl:(0,s.Qq)("logo_url"),website:(0,s.Qq)("website"),isActive:(0,f.zM)("is_active").notNull().default(!0),createdAt:(0,c.vE)("created_at").notNull().defaultNow(),updatedAt:(0,c.vE)("updated_at").notNull().defaultNow()}),er=(0,o.cJ)("products",{id:(0,s.Qq)("id").primaryKey().default((0,m.ll)(A())),slug:(0,s.Qq)("slug").notNull().unique(),name:(0,s.Qq)("name").notNull(),description:(0,s.Qq)("description").notNull(),shortDescription:(0,s.Qq)("short_description"),status:(0,s.Qq)("status").notNull().default(G.DRAFT),brandId:(0,s.Qq)("brand_id").references(()=>et.id),categoryId:(0,s.Qq)("category_id").references(()=>ee.id),thumbnailUrl:(0,s.Qq)("thumbnail_url"),basePrice:(0,_.sH)("base_price").$type().notNull(),price:(0,_.sH)("price").$type(),discountPrice:(0,_.sH)("discount_price").$type(),purchasePrice:(0,_.sH)("purchase_price").$type(),currency:(0,s.Qq)("currency").notNull().default("NPR"),tags:(0,s.Qq)("tags").array().notNull().default((0,m.ll)(v())),images:(0,s.Qq)("images").array().notNull().default((0,m.ll)(h())),sku:(0,s.Qq)("sku"),isActive:(0,f.zM)("is_active").notNull().default(!0),isFeatured:(0,f.zM)("is_featured").notNull().default(!1),isNewArrival:(0,f.zM)("is_new_arrival").notNull().default(!1),inventory:(0,p.nd)("inventory").notNull().default(0),lowStockThreshold:(0,p.nd)("low_stock_threshold").notNull().default(0),orderCount:(0,p.nd)("order_count").notNull().default(0),purchaseCount:(0,p.nd)("purchase_count").notNull().default(0),viewCount:(0,p.nd)("view_count").notNull().default(0),popularityScore:(0,_.sH)("popularity_score").notNull().default("0"),ratingAvg:(0,_.sH)("rating_avg").notNull().default("0"),ratingCount:(0,p.nd)("rating_count").notNull().default(0),seoTitle:(0,s.Qq)("seo_title"),seoDescription:(0,s.Qq)("seo_description"),metaTitle:(0,s.Qq)("meta_title"),metaDescription:(0,s.Qq)("meta_description"),weight:(0,_.sH)("weight").$type(),dimensions:(0,N.Pq)("dimensions"),attributes:(0,N.Pq)("attributes"),createdAt:(0,c.vE)("created_at").notNull().defaultNow(),updatedAt:(0,c.vE)("updated_at").notNull().defaultNow()}),en=(0,o.cJ)("product_variants",{id:(0,s.Qq)("id").primaryKey().default((0,m.ll)(R())),productId:(0,s.Qq)("product_id").notNull().references(()=>er.id),sku:(0,s.Qq)("sku").notNull().unique(),attributes:(0,N.Pq)("attributes"),price:(0,_.sH)("price").$type().notNull(),currency:(0,s.Qq)("currency").notNull().default("NPR"),inventoryQuantity:(0,p.nd)("inventory_quantity").notNull().default(0),isDefault:(0,f.zM)("is_default").notNull().default(!1),createdAt:(0,c.vE)("created_at").notNull().defaultNow(),updatedAt:(0,c.vE)("updated_at").notNull().defaultNow()}),el=(0,o.cJ)("product_images",{id:(0,s.Qq)("id").primaryKey().default((0,m.ll)(D())),productId:(0,s.Qq)("product_id").notNull().references(()=>er.id),imageUrl:(0,s.Qq)("image_url").notNull(),altText:(0,s.Qq)("alt_text"),sortOrder:(0,p.nd)("sort_order").notNull().default(0),createdAt:(0,c.vE)("created_at").notNull().defaultNow()}),ed=(0,o.cJ)("inventory_adjustments",{id:(0,s.Qq)("id").primaryKey().default((0,m.ll)(T())),productVariantId:(0,s.Qq)("product_variant_id").notNull().references(()=>en.id),quantityChange:(0,p.nd)("quantity_change").notNull(),reason:(0,s.Qq)("reason"),referenceType:(0,s.Qq)("reference_type"),referenceId:(0,s.Qq)("reference_id"),createdAt:(0,c.vE)("created_at").notNull().defaultNow()}),eu=(0,o.cJ)("carts",{id:(0,s.Qq)("id").primaryKey().default((0,m.ll)(P())),userId:(0,s.Qq)("user_id").references(()=>$.id),sessionId:(0,s.Qq)("session_id"),status:(0,s.Qq)("status").notNull().default("ACTIVE"),createdAt:(0,c.vE)("created_at").notNull().defaultNow(),updatedAt:(0,c.vE)("updated_at").notNull().defaultNow()}),ei=(0,o.cJ)("cart_items",{id:(0,s.Qq)("id").primaryKey().default((0,m.ll)(w())),cartId:(0,s.Qq)("cart_id").notNull().references(()=>eu.id),productId:(0,s.Qq)("product_id").notNull().references(()=>er.id),productVariantId:(0,s.Qq)("product_variant_id").notNull().references(()=>en.id),quantity:(0,p.nd)("quantity").notNull().default(1),unitPrice:(0,_.sH)("unit_price").$type().notNull(),currency:(0,s.Qq)("currency").notNull().default("NPR"),createdAt:(0,c.vE)("created_at").notNull().defaultNow(),updatedAt:(0,c.vE)("updated_at").notNull().defaultNow()}),ea=(0,o.cJ)("orders",{id:(0,s.Qq)("id").primaryKey().default((0,m.ll)(S())),orderNumber:(0,s.Qq)("order_number").notNull().unique(),userId:(0,s.Qq)("user_id").references(()=>$.id),cartId:(0,s.Qq)("cart_id").references(()=>eu.id),status:(0,s.Qq)("status").notNull().default(x.PENDING_PAYMENT),paymentStatus:(0,s.Qq)("payment_status").notNull().default(V.PENDING),fulfillmentStatus:(0,s.Qq)("fulfillment_status").notNull().default(B.PENDING),subtotal:(0,_.sH)("subtotal").notNull(),taxTotal:(0,_.sH)("tax_total").notNull().default("0"),shippingTotal:(0,_.sH)("shipping_total").notNull().default("0"),discountTotal:(0,_.sH)("discount_total").notNull().default("0"),grandTotal:(0,_.sH)("grand_total").notNull(),currency:(0,s.Qq)("currency").notNull().default("NPR"),shippingAddressId:(0,s.Qq)("shipping_address_id").references(()=>X.id),billingAddressId:(0,s.Qq)("billing_address_id").references(()=>X.id),notes:(0,s.Qq)("notes"),placedAt:(0,c.vE)("placed_at"),createdAt:(0,c.vE)("created_at").notNull().defaultNow(),updatedAt:(0,c.vE)("updated_at").notNull().defaultNow()}),eo=(0,o.cJ)("order_items",{id:(0,s.Qq)("id").primaryKey().default((0,m.ll)(b())),orderId:(0,s.Qq)("order_id").notNull().references(()=>ea.id),productId:(0,s.Qq)("product_id").notNull().references(()=>er.id),productVariantId:(0,s.Qq)("product_variant_id").notNull().references(()=>en.id),nameSnapshot:(0,s.Qq)("name_snapshot").notNull(),skuSnapshot:(0,s.Qq)("sku_snapshot"),price:(0,_.sH)("price").notNull(),currency:(0,s.Qq)("currency").notNull().default("NPR"),quantity:(0,p.nd)("quantity").notNull(),metadata:(0,N.Pq)("metadata"),createdAt:(0,c.vE)("created_at").notNull().defaultNow()}),es=(0,o.cJ)("payments",{id:(0,s.Qq)("id").primaryKey().default((0,m.ll)(C())),orderId:(0,s.Qq)("order_id").notNull().references(()=>ea.id),provider:(0,s.Qq)("provider").notNull(),providerReference:(0,s.Qq)("provider_reference"),status:(0,s.Qq)("status").notNull().default(V.PENDING),amount:(0,_.sH)("amount").notNull(),currency:(0,s.Qq)("currency").notNull().default("NPR"),capturedAt:(0,c.vE)("captured_at"),metadata:(0,N.Pq)("metadata"),createdAt:(0,c.vE)("created_at").notNull().defaultNow(),updatedAt:(0,c.vE)("updated_at").notNull().defaultNow()}),ec=(0,o.cJ)("shipments",{id:(0,s.Qq)("id").primaryKey().default((0,m.ll)(K())),orderId:(0,s.Qq)("order_id").notNull().references(()=>ea.id),carrier:(0,s.Qq)("carrier"),trackingNumber:(0,s.Qq)("tracking_number"),status:(0,s.Qq)("status").notNull().default(B.PENDING),shippedAt:(0,c.vE)("shipped_at"),deliveredAt:(0,c.vE)("delivered_at"),metadata:(0,N.Pq)("metadata"),createdAt:(0,c.vE)("created_at").notNull().defaultNow(),updatedAt:(0,c.vE)("updated_at").notNull().defaultNow()}),ef=(0,o.cJ)("gallery",{id:(0,s.Qq)("id").primaryKey().default((0,m.ll)(L())),title:(0,s.Qq)("title").notNull(),description:(0,s.Qq)("description"),category:(0,s.Qq)("category").notNull().default(z.FACTORY),imageUrl:(0,s.Qq)("image_url").notNull(),cloudinaryPublicId:(0,s.Qq)("cloudinary_public_id").notNull(),altText:(0,s.Qq)("alt_text"),isActive:(0,f.zM)("is_active").notNull().default(!0),sortOrder:(0,p.nd)("sort_order").notNull().default(0),tags:(0,s.Qq)("tags").array().default((0,m.ll)(U())),metadata:(0,N.Pq)("metadata"),createdAt:(0,c.vE)("created_at").notNull().defaultNow(),updatedAt:(0,c.vE)("updated_at").notNull().defaultNow()}),eN=(0,a.K1)($,e=>{let{one:t,many:r}=e;return{profile:t(Y,{fields:[$.id],references:[Y.userId]}),addresses:r(X),carts:r(eu),orders:r(ea),accounts:r(j),sessions:r(Z)}}),ep=(0,a.K1)(Y,e=>{let{one:t}=e;return{user:t($,{fields:[Y.userId],references:[$.id]})}}),e_=(0,a.K1)(j,e=>{let{one:t}=e;return{user:t($,{fields:[j.userId],references:[$.id]})}}),em=(0,a.K1)(Z,e=>{let{one:t}=e;return{user:t($,{fields:[Z.userId],references:[$.id]})}}),eq=(0,a.K1)(X,e=>{let{one:t}=e;return{user:t($,{fields:[X.userId],references:[$.id]})}}),ey=(0,a.K1)(ee,e=>{let{one:t,many:r}=e;return{parent:t(ee,{fields:[ee.parent_id],references:[ee.id],relationName:"category_parent"}),children:r(ee,{relationName:"category_parent"}),products:r(er)}}),eE=(0,a.K1)(et,e=>{let{many:t}=e;return{products:t(er)}}),eQ=(0,a.K1)(er,e=>{let{one:t,many:r}=e;return{brand:t(et,{fields:[er.brandId],references:[et.id]}),category:t(ee,{fields:[er.categoryId],references:[ee.id]}),variants:r(en),images:r(el),orderItems:r(eo),cartItems:r(ei)}}),eg=(0,a.K1)(en,e=>{let{one:t,many:r}=e;return{product:t(er,{fields:[en.productId],references:[er.id]}),inventoryAdjustments:r(ed),cartItems:r(ei),orderItems:r(eo)}}),eI=(0,a.K1)(el,e=>{let{one:t}=e;return{product:t(er,{fields:[el.productId],references:[er.id]})}}),eA=(0,a.K1)(ed,e=>{let{one:t}=e;return{productVariant:t(en,{fields:[ed.productVariantId],references:[en.id]})}}),ev=(0,a.K1)(eu,e=>{let{one:t,many:r}=e;return{user:t($,{fields:[eu.userId],references:[$.id]}),items:r(ei)}}),eh=(0,a.K1)(ei,e=>{let{one:t}=e;return{cart:t(eu,{fields:[ei.cartId],references:[eu.id]}),product:t(er,{fields:[ei.productId],references:[er.id]}),variant:t(en,{fields:[ei.productVariantId],references:[en.id]})}}),eR=(0,a.K1)(ea,e=>{let{one:t,many:r}=e;return{user:t($,{fields:[ea.userId],references:[$.id]}),cart:t(eu,{fields:[ea.cartId],references:[eu.id]}),shippingAddress:t(X,{fields:[ea.shippingAddressId],references:[X.id],relationName:"shippingAddress"}),billingAddress:t(X,{fields:[ea.billingAddressId],references:[X.id],relationName:"billingAddress"}),items:r(eo),payments:r(es),shipments:r(ec)}}),eD=(0,a.K1)(eo,e=>{let{one:t}=e;return{order:t(ea,{fields:[eo.orderId],references:[ea.id]}),product:t(er,{fields:[eo.productId],references:[er.id]}),variant:t(en,{fields:[eo.productVariantId],references:[en.id]})}}),eT=(0,a.K1)(es,e=>{let{one:t}=e;return{order:t(ea,{fields:[es.orderId],references:[ea.id]})}}),eP=(0,a.K1)(ec,e=>{let{one:t}=e;return{order:t(ea,{fields:[ec.orderId],references:[ea.id]})}}),ew=(0,o.cJ)("site_settings",{id:(0,s.Qq)("id").primaryKey().default((0,m.ll)(k())),key:(0,s.Qq)("key").notNull().unique(),value:(0,s.Qq)("value").notNull(),type:(0,s.Qq)("type").notNull().default("STRING"),description:(0,s.Qq)("description"),category:(0,s.Qq)("category").default("general"),isPublic:(0,f.zM)("is_public").default(!1),createdAt:(0,c.vE)("created_at").notNull().defaultNow(),updatedAt:(0,c.vE)("updated_at").notNull().defaultNow()}),eS=(0,a.K1)(ew,e=>{let{}=e;return{}}),eb=(0,o.cJ)("user_activities",{id:(0,s.Qq)("id").primaryKey().default((0,m.ll)(M())),userId:(0,s.Qq)("user_id").references(()=>$.id),sessionId:(0,s.Qq)("session_id"),productId:(0,s.Qq)("product_id").references(()=>er.id),activityType:(0,s.Qq)("activity_type").notNull(),metadata:(0,N.Pq)("metadata"),createdAt:(0,c.vE)("created_at").notNull().defaultNow()}),eC=(0,a.K1)(eb,e=>{let{one:t}=e;return{user:t($,{fields:[eb.userId],references:[$.id]}),product:t(er,{fields:[eb.productId],references:[er.id]})}}),eK=(0,o.cJ)("user_interests",{id:(0,s.Qq)("id").primaryKey().default((0,m.ll)(O())),userId:(0,s.Qq)("user_id").references(()=>$.id),categoryId:(0,s.Qq)("category_id").references(()=>ee.id),score:(0,_.sH)("score").default("1"),createdAt:(0,c.vE)("created_at").notNull().defaultNow(),updatedAt:(0,c.vE)("updated_at").notNull().defaultNow()}),eL=(0,a.K1)(eK,e=>{let{one:t}=e;return{user:t($,{fields:[eK.userId],references:[$.id]}),category:t(ee,{fields:[eK.categoryId],references:[ee.id]})}});r(60636);var eU=r(10924);let ek=eU.env.DATABASE_URL;if(!ek)throw Error("DATABASE_URL environment variable is not set");let eM=(0,u.A)(ek,{ssl:"require",max:10,idle_timeout:20,connect_timeout:10,prepare:!1});(0,d.f)(eM,{schema:n}),eU.on("beforeExit",async()=>{await eM.end()});var eO=r(20707),eF=r.n(eO);let eH={level:r(10924).env.LOG_LEVEL||"info",formatters:{level:e=>({level:e}),bindings:e=>({pid:e.pid,hostname:e.hostname,service:"kalkal-ecommerce"})},timestamp:eF().stdTimeFunctions.isoTime,redact:{paths:["password","token","authorization","cookie","req.headers.authorization","req.headers.cookie",'res.headers["set-cookie"]'],censor:"[REDACTED]"}},eG=eF()(eH,void 0),eJ=e=>"object"==typeof e&&null!==e&&!Array.isArray(e),ex=e=>{let t=e.bind(eG);return function(e,r){for(var n=arguments.length,l=Array(n>2?n-2:0),d=2;d<n;d++)l[d-2]=arguments[d];if("string"==typeof e){let n=eJ(r)?r:void 0;t(null!=n?n:{},e,...eJ(r)?l:[r,...l].filter(e=>void 0!==e));return}t(e,r,...l)}};eG.info=ex(eG.info),eG.warn=ex(eG.warn),eG.error=ex(eG.error),eG.debug=ex(eG.debug);class eV{static getInstance(){return eV.instance||(eV.instance=new eV),eV.instance}recordMetric(e,t){this.metrics.has(e)||this.metrics.set(e,[]);let r=this.metrics.get(e);r.push(t),r.length>1e3&&r.shift()}getMetrics(e){let t=this.metrics.get(e)||[];if(0===t.length)return null;let r=[...t].sort((e,t)=>e-t);return{count:t.length,min:r[0],max:r[r.length-1],avg:t.reduce((e,t)=>e+t,0)/t.length,p50:r[Math.floor(.5*r.length)],p95:r[Math.floor(.95*r.length)],p99:r[Math.floor(.99*r.length)]}}getAllMetrics(){let e={};for(let[t]of this.metrics)e[t]=this.getMetrics(t);return e}constructor(){this.metrics=new Map}}function eB(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l.OS;return(0,l.vv)(e,t)}function ez(e){let t=e.reduce((e,t)=>{var r,n;return e+(null!=(n=null!=(r=t.product.discountPrice)?r:t.product.price)?n:0)*t.quantity},0),r=e.reduce((e,t)=>e+t.quantity,0),n=(0,l.A4)(l.OS),d=t>=n?0:200,u=.13*t;return{subtotal:t,shipping:d,tax:u,total:t+d+u,itemsCount:r,freeShippingThreshold:n,freeShippingRemaining:Math.max(0,n-t)}}eV.getInstance()},96848:()=>{}}]);