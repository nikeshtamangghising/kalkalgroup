(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4798],{44026:(e,s,t)=>{Promise.resolve().then(t.bind(t,63829))},63829:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>w});var a=t(49095),r=t(28175),l=t(76447),i=t.n(l),n=t(33690),d=t(69692),c=t(8327),o=t(61449),x=t(54603),m=t(66617),h=t(38113),p=t(55103),u=t(86948),g=t(3998),j=t(65142),f=t(78334),y=t(87110),N=t(95244);function w(){let[e,s]=(0,r.useState)(null),[t,l]=(0,r.useState)(!0),[w,v]=(0,r.useState)(""),[b,E]=(0,r.useState)(""),[C,D]=(0,r.useState)(""),[S,A]=(0,r.useState)(1),[k,P]=(0,r.useState)([]);(0,r.useEffect)(()=>{R()},[S,b,C]);let R=async()=>{l(!0),v("");try{let e=new URLSearchParams({page:S.toString(),limit:"10"});b&&e.append("search",b),C&&e.append("status",C);let t=await fetch("/api/orders?".concat(e));if(!t.ok)throw Error("Failed to fetch orders");let a=await t.json();s(a)}catch(e){v(e instanceof Error?e.message:"Failed to load orders")}finally{l(!1)}},I=async(e,s)=>{try{if(!(await fetch("/api/orders/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:s})})).ok)throw Error("Failed to update order status");R()}catch(e){alert(e instanceof Error?e.message:"Failed to update order")}},L=async e=>{if(0===k.length)return void alert("Please select orders to update");if(window.confirm("Are you sure you want to update ".concat(k.length," orders to ").concat(e,"?")))try{if(!(await fetch("/api/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"bulkUpdateStatus",orderIds:k,status:e})})).ok)throw Error("Failed to update orders");P([]),R()}catch(e){alert(e instanceof Error?e.message:"Failed to update orders")}},F=e=>{A(e),window.scrollTo({top:0,behavior:"smooth"})};return(0,a.jsx)(p.A,{children:(0,a.jsx)(h.A,{children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Orders"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Manage customer orders and fulfillment"})]}),(0,a.jsx)(u.Zp,{children:(0,a.jsx)(u.Wu,{className:"p-6",children:(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),A(1),R()},className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsx)("div",{className:"md:col-span-2",children:(0,a.jsx)(j.A,{type:"text",placeholder:"Search by order ID, customer name, or email...",value:b,onChange:e=>E(e.target.value),className:"w-full"})}),(0,a.jsx)("div",{children:(0,a.jsxs)("select",{value:C,onChange:e=>D(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",children:[(0,a.jsx)("option",{value:"",children:"All Statuses"}),(0,a.jsx)("option",{value:"PENDING",children:"Pending"}),(0,a.jsx)("option",{value:"PROCESSING",children:"Processing"}),(0,a.jsx)("option",{value:"SHIPPED",children:"Shipped"}),(0,a.jsx)("option",{value:"DELIVERED",children:"Delivered"}),(0,a.jsx)("option",{value:"CANCELLED",children:"Cancelled"}),(0,a.jsx)("option",{value:"REFUNDED",children:"Refunded"})]})})]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsxs)(g.A,{type:"submit",className:"flex items-center space-x-2",children:[(0,a.jsx)(x.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Search"})]}),(0,a.jsx)(g.A,{type:"button",variant:"outline",onClick:()=>{E(""),D(""),A(1)},children:"Clear Filters"})]})]})})}),k.length>0&&(0,a.jsx)(u.Zp,{children:(0,a.jsx)(u.Wu,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("span",{className:"text-sm text-gray-600",children:[k.length," orders selected"]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)(g.A,{size:"sm",onClick:()=>L("PROCESSING"),children:"Mark as Processing"}),(0,a.jsx)(g.A,{size:"sm",onClick:()=>L("SHIPPED"),children:"Mark as Shipped"}),(0,a.jsx)(g.A,{size:"sm",onClick:()=>L("DELIVERED"),children:"Mark as Delivered"}),(0,a.jsx)(g.A,{size:"sm",variant:"outline",onClick:()=>P([]),children:"Clear Selection"})]})]})})}),(0,a.jsxs)(u.Zp,{children:[(0,a.jsx)(u.aR,{children:(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsx)("h2",{className:"text-lg font-medium text-gray-900",children:e?"".concat(e.pagination.total," Orders"):"Orders"})})}),(0,a.jsx)(u.Wu,{children:t?(0,a.jsx)("div",{className:"flex justify-center items-center py-16",children:(0,a.jsx)(f.h,{size:"lg"})}):w?(0,a.jsxs)("div",{className:"text-center py-16",children:[(0,a.jsx)("p",{className:"text-red-600 mb-4",children:w}),(0,a.jsx)(g.A,{onClick:R,children:"Try Again"})]}):e&&e.data.length>0?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left",children:(0,a.jsx)("input",{type:"checkbox",checked:e.data.length>0&&k.length===e.data.length,onChange:()=>{e&&(k.length===e.data.length?P([]):P(e.data.map(e=>e.id)))},className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"})}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Order"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Customer"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Items"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,a.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:e.data.map(e=>{var s,t;return(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("input",{type:"checkbox",checked:k.includes(e.id),onChange:()=>{var s;return s=e.id,void P(e=>e.includes(s)?e.filter(e=>e!==s):[...e,s])},className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"text-sm font-medium text-gray-900",children:["#",e.id.slice(-8).toUpperCase()]}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:new Date(e.createdAt.toString()).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"})})]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:(null==(s=e.user)?void 0:s.name)||"Guest User"}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:(null==(t=e.user)?void 0:t.email)||"No email"})]})}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[e.items.length," ",1===e.items.length?"item":"items"]}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:(0,y.$g)("string"==typeof e.grandTotal?parseFloat(e.grandTotal):e.grandTotal)}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(e=>{switch(e){case"PENDING":return(0,a.jsx)(n.A,{className:"h-4 w-4 text-yellow-500"});case"PROCESSING":return(0,a.jsx)(d.A,{className:"h-4 w-4 text-blue-500"});case"SHIPPED":return(0,a.jsx)(c.A,{className:"h-4 w-4 text-purple-500"});case"DELIVERED":return(0,a.jsx)(c.A,{className:"h-4 w-4 text-green-500"});case"CANCELLED":return(0,a.jsx)(o.A,{className:"h-4 w-4 text-red-500"});case"REFUNDED":return(0,a.jsx)(o.A,{className:"h-4 w-4 text-orange-500"});default:return(0,a.jsx)(n.A,{className:"h-4 w-4 text-gray-500"})}})(e.status),(0,a.jsxs)("select",{value:e.status,onChange:s=>I(e.id,s.target.value),className:"text-xs font-medium rounded-full px-2 py-1 border-0 focus:ring-2 focus:ring-indigo-500 ".concat((e=>{switch(e){case"PENDING":return"bg-yellow-100 text-yellow-800";case"PROCESSING":return"bg-blue-100 text-blue-800";case"SHIPPED":return"bg-purple-100 text-purple-800";case"DELIVERED":return"bg-green-100 text-green-800";case"CANCELLED":return"bg-red-100 text-red-800";case"REFUNDED":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}})(e.status)),children:[(0,a.jsx)("option",{value:"PENDING",children:"Pending"}),(0,a.jsx)("option",{value:"PROCESSING",children:"Processing"}),(0,a.jsx)("option",{value:"SHIPPED",children:"Shipped"}),(0,a.jsx)("option",{value:"DELIVERED",children:"Delivered"}),(0,a.jsx)("option",{value:"CANCELLED",children:"Cancelled"}),(0,a.jsx)("option",{value:"REFUNDED",children:"Refunded"})]})]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,a.jsxs)("div",{className:"flex items-center justify-end space-x-2",children:[(0,a.jsx)(i(),{href:"/admin/orders/".concat(e.id),children:(0,a.jsx)(g.A,{variant:"ghost",size:"sm",children:(0,a.jsx)(m.A,{className:"h-4 w-4"})})}),(0,a.jsx)(N.A,{orderId:e.id,variant:"ghost",size:"sm",showText:!1,className:"!px-2"})]})})]},e.id)})})]})}),e.pagination.totalPages>1&&(0,a.jsx)("div",{className:"flex justify-center mt-6",children:(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)(g.A,{variant:"outline",disabled:1===S,onClick:()=>F(S-1),children:"Previous"}),Array.from({length:e.pagination.totalPages},(e,s)=>s+1).filter(s=>1===s||s===e.pagination.totalPages||2>=Math.abs(s-S)).map((e,s,t)=>(0,a.jsxs)("div",{className:"flex items-center",children:[s>0&&t[s-1]!==e-1&&(0,a.jsx)("span",{className:"px-2 text-gray-500",children:"..."}),(0,a.jsx)(g.A,{variant:S===e?"primary":"outline",onClick:()=>F(e),children:e})]},e)),(0,a.jsx)(g.A,{variant:"outline",disabled:S===e.pagination.totalPages,onClick:()=>F(S+1),children:"Next"})]})})]}):(0,a.jsxs)("div",{className:"text-center py-16",children:[(0,a.jsx)("div",{className:"w-16 h-16 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center",children:(0,a.jsx)(n.A,{className:"w-8 h-8 text-gray-400"})}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No orders found"}),(0,a.jsx)("p",{className:"text-gray-500",children:b||C?"Try adjusting your search or filter criteria.":"Orders will appear here when customers make purchases."})]})})]})]})})})}},65142:(e,s,t)=>{"use strict";t.d(s,{A:()=>n});var a=t(49095),r=t(28175),l=t(2821);let i=(0,r.forwardRef)((e,s)=>{let{className:t,label:r,error:i,helperText:n,id:d,...c}=e,o=d||"input-".concat(Math.random().toString(36).substr(2,9));return(0,a.jsxs)("div",{className:"w-full",children:[r&&(0,a.jsx)("label",{htmlFor:o,className:"block text-sm font-medium text-gray-700 mb-1",children:r}),(0,a.jsx)("input",{id:o,className:(0,l.$)("block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",i&&"border-red-300 focus:ring-red-500 focus:border-red-500",t),ref:s,...c}),i&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-600",children:i}),n&&!i&&(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:n})]})});i.displayName="Input";let n=i},86948:(e,s,t)=>{"use strict";t.d(s,{Wu:()=>d,ZB:()=>c,Zp:()=>i,aR:()=>n});var a=t(49095),r=t(28175),l=t(2821);let i=(0,r.forwardRef)((e,s)=>{let{className:t,variant:r="default",...i}=e;return(0,a.jsx)("div",{ref:s,className:(0,l.$)("rounded-lg",{default:"bg-white border border-gray-200",outlined:"bg-white border-2 border-gray-300",elevated:"bg-white shadow-lg border border-gray-100"}[r],t),...i,suppressHydrationWarning:!0})});i.displayName="Card";let n=(0,r.forwardRef)((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,l.$)("px-4 py-3 sm:px-6 sm:py-4 border-b border-gray-200",t),...r,suppressHydrationWarning:!0})});n.displayName="CardHeader";let d=(0,r.forwardRef)((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,l.$)("px-4 py-3 sm:px-6 sm:py-4",t),...r,suppressHydrationWarning:!0})});d.displayName="CardContent";let c=(0,r.forwardRef)((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("h3",{ref:s,className:(0,l.$)("text-lg font-semibold leading-6 text-gray-900",t),...r,suppressHydrationWarning:!0})});c.displayName="CardTitle",(0,r.forwardRef)((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("p",{ref:s,className:(0,l.$)("text-sm text-gray-600 mt-1",t),...r,suppressHydrationWarning:!0})}).displayName="CardDescription",(0,r.forwardRef)((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,l.$)("px-4 py-3 sm:px-6 sm:py-4 border-t border-gray-200",t),...r,suppressHydrationWarning:!0})}).displayName="CardFooter"},95244:(e,s,t)=>{"use strict";t.d(s,{A:()=>n});var a=t(49095),r=t(28175),l=t(45018),i=t(3998);function n(e){let{orderId:s,variant:t="outline",size:n="sm",className:d="",showText:c=!0}=e,[o,x]=(0,r.useState)(!1),m=async()=>{try{x(!0),console.log("Starting download for order:",s);let e=await fetch("/api/orders/".concat(s,"/invoice"));if(console.log("Response status:",e.status),!e.ok){let s=await e.text();throw console.error("API Error:",s),Error("Failed to download invoice: ".concat(e.status," - ").concat(s))}let t=await e.blob();console.log("Blob size:",t.size);let a="invoice-".concat(s.slice(-8).toUpperCase(),".").concat("pdf");console.log("Download filename:",a);let r=window.URL.createObjectURL(t),l=document.createElement("a");l.href=r,l.download=a,document.body.appendChild(l),l.click(),document.body.removeChild(l),window.URL.revokeObjectURL(r),console.log("Download completed successfully")}catch(e){console.error("Download error:",e),alert("Failed to download invoice: ".concat(e instanceof Error?e.message:"Unknown error"))}finally{x(!1)}};return(0,a.jsx)(i.A,{onClick:m,disabled:o,variant:t,size:n,className:d,children:o?(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsxs)("svg",{className:"animate-spin h-4 w-4 mr-2",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),c&&"Downloading..."]}):(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(l.A,{className:"h-4 w-4 mr-2"}),c&&"Download Invoice"]})})}}},e=>{e.O(0,[6447,9885,7640,5750,2313,5295,3575,7358],()=>e(e.s=44026)),_N_E=e.O()}]);